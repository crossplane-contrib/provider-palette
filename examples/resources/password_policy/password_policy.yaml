apiVersion: password.palette.crossplane.io/v1alpha1
kind: Policy
metadata:
  name: comprehensive-password-policy
  annotations:
    description: "Comprehensive password policy for enhanced security"
    crossplane.io/external-name: "comprehensive-policy"
  labels:
    app: password-policy
    environment: production
spec:
  deletionPolicy: Delete
  forProvider:
    # Password complexity requirements
    minPasswordLength: 9
    minUppercaseLetters: 2
    minLowercaseLetters: 2
    minDigits: 2
    minSpecialCharacters: 2
    
    # Password expiry settings
    passwordExpiryDays: 333
    
    # # Reminder settings
    firstReminderDays: 7
    
    # Custom regex pattern (optional - uncomment if you want to use regex instead of individual requirements)
    # passwordRegex: "^(?=.*[A-Z])(?=.*[a-z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{12,}$"
  
  # Provider configuration reference
  providerConfigRef:
    name: default
  
  # Optional: Write connection details to a secret
  # writeConnectionSecretToRef:
  #   name: password-policy-secret
  #   namespace: crossplane-system
